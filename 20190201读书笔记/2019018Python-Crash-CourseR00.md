# 2019018Python-Crash-CourseR00

## 记忆时间

2019-12-10；2020-01-17

## 卡片

### 0101. 主题卡 —— Python 编程规范汇总

Python 编程规范汇总：

1、函数名用小写单词加下划线（不同于 Java、PHP 中的驼峰命名）。

2、定义函数，给形参指定默认值时，等号两边不要有空格。

3、类名应采用「驼峰命名法」，即将类名中的每个单词的首字母都大写，而不使用下划线。实例名和模块名都采用小写格式，并在单词之间加上下划线。

4、对于每个类，都应紧跟在类定义后面包含一个文档字符串。这种文档字符串简要地描述类的功能，并遵循编写函数的文档字符串时采用的格式约定。每个模块也都应包含一个文档字符串，对其中的类可用于做什么进行描述。

5、可使用空行来组织代码，但不要滥用。在类中，可使用一个空行来分隔方法；而在模块中，可使用两个空行来分隔类。

6、需要同时导入标准库中的模块和你编写的模块时，先编写导入标准库模块的 import 语句，再添加一个空行，然后编写导入你自己编写的模块的 import 语句。在包含多条 import 语句的程序中，这种做法让人更容易明白程序使用的各个模块都来自何方。

### 0201. 术语卡 —— 列表解析

前面介绍的生成列表 squares 的方式包含三四行代码，而列表解析让你只需编写一行代码就能生成这样的列表。列表解析将 for 循环和创建新元素的代码合并成一行，并自动附加新元素。面向初学者的书籍并非都会介绍列表解析，这里之所以介绍列表解析，是因为等你开始阅读他人编写的代码时，很可能会遇到它们。

```py
squares = [value**2 for value in range(1,11)]
print(squares)
```

要使用这种语法，首先指定一个描述性的列表名，如 squares；然后，指定一个左方括号，并定义一个表达式，用于生成你要存储到列表中的值。在这个示例中，表达式为 value^2，它计算平方值。接下来，编写一个 for 循环，用于给表达式提供值，再加上右方括号。在这个示例中，for 循环为 `for value in range(1, 11)`，它将值 1-10 提供给表达式 `value**2`。请注意，这里的 for 语句末尾没有冒号。

1-3『

数字列表涉及到的函数：1）`range()` 函数可以生成一系列数字，将 `range()` 函数与 `list()` 函数结合起来即可创建数字列表。2）对数字列表简单计算的函数，比如取最大值 `max()`，取最小值 `min()`，取和 `sum()`。

好好去了解一下列表解析的概念。回复：能用列表解析的实现就用列表解析，简洁嘛，而且在 pandas 作者的那本书（数据分析的那本）里也推荐过这种实现。（2020-08-28）

补充：书籍「2020017Programming-Collective-Intelligence」里也同样强烈推荐了「列表解析」的写法，而且还能增加「条件」筛选。列表解析，做一张术语卡片。（2021-02-19）——已完成

```py
[value**2 for value in range(1, 11) if value > 5]

out:
[36, 49, 64, 81, 100]
```

』

### 0202. 术语卡 —— 

### 0301. 人名卡 —— 

根据这些证据和案例，找出源头和提出术语的人是谁 —— 产生一张人名卡，并且分析他为什么牛，有哪些作品，生平经历是什么。

### 0401. 金句卡 —— 

最后根据他写的非常震撼的话语 —— 产生一张金句卡。

### 0501. 任意卡 —— break 和 continue 的使用原则

首先这两个都只是针对循环语句的。1）break 是直接从该点退出循环，不执行其后面的语句，退出循环；2）continue 是直接从该点返回到判断语句，也是忽略后面的语句，但不退出循环。

## 前言

如何学习编写第一个程序，每个程序员都有不同的故事。我还是个孩子时就开始学习编程了，当时我父亲在计算时代的先锋之一 —— 数字设备公司（Digital Equipment Corporation）工作。我使用一台简陋的计算机编写了第一个程序，这台计算机是父亲在家里的地下室组装而成的，它没有机箱，裸露的主板与键盘相连，显示器是裸露的阴极射线管。我编写的这个程序是一款简单的猜数字游戏，其输出类似于下面这样。

看到家人玩着我编写的游戏，而且它完全按我预期的方式运行，我心里不知有多满足。此情此景我永远都忘不了。儿童时期的这种体验一直影响我至今。现在，每当我通过编写程序解决了一个问题时，心里都会感到非常满足。相比于孩提时期，我现在编写的软件满足了更大的需求，但通过编写程序获得的满足感几乎与从前一样。

本书旨在让你成为优秀的程序员，具体地说，是优秀的 Python 程序员。通过阅读本书，你将迅速掌握编程概念，打下坚实的基础，并养成良好的习惯。阅读本书后，你就可以开始学习 Python 高级技术，并能够更轻松地掌握其他编程语言。

在本书的第一部分，你将学习编写 Python 程序时需要熟悉的基本编程概念，你刚接触几乎任何编程语言时都需要学习这些概念。你将学习各种数据以及在程序中将数据存储到列表和字典中的方式。你将学习如何创建数据集合以及如何高效地遍历这些集合。你将学习使用 while 和 if 语句来检查条件，并在条件满足时执行代码的一部分，而在条件不满足时执行代码的另一部分 —— 这可为自动完成处理提供极大的帮助。

你将学习获取用户输入，让程序能够与用户交互，并在用户没停止输入时保持运行状态。你将探索如何编写函数来让程序的各个部分可重用，这样你编写执行特定任务的代码后，想使用它多少次都可以。然后，你将学习使用类来扩展这种概念以实现更复杂的行为，从而让非常简单的程序也能处理各种不同的情形。你将学习编写妥善处理常见错误的程序。学习这些基本概念后，你就能编写一些简短的程序来解决一些明确的问题。最后，你将向中级编程迈出第一步，学习如何为代码编写测试，以便在进一步改进程序时不用担心可能引入 bug。第一部分介绍的知识让你能够开发更大、更复杂的项目。

在第二部分，你将利用在第一部分学到的知识来开发三个项目。你可以根据自己的情况，以最合适的顺序完成这些项目；你也可以选择只完成其中的某些项目。在第一个项目（第 12~14 章）中，你将创建一个类似于《太空入侵者》的射击游戏。这个游戏名为《外星人入侵》，它包含多个难度不断增加的等级。完成这个项目后，你就能够自己动手开发 2D 游戏了。

第二个项目（第 15~17 章）介绍数据可视化。数据科学家的目标是通过各种可视化技术来搞懂海量信息。你将使用通过代码生成的数据集、已经从网络下载下来的数据集以及程序自动下载的数据集。完成这个项目后，你将能够编写能对大型数据集进行筛选的程序，并以可视化方式将筛选出来的数据呈现出来。

在第三个项目（第 18~20 章）中，你将创建一个名为「学习笔记」的小型 Web 应用程序。这个项目能够让用户将学到的与特定主题相关的概念记录下来。你将能够分别记录不同的主题，还可以让其他人建立账户并开始记录自己的学习笔记。你还将学习如何部署这个项目，让任何人都能够通过网络访问它，而不管他身处何方。

## 总结汇总

1、初步了解 Python，安装 Python3，安装文本编辑器 sublime text。

2、如何使用变量和字符串和数字的数据类型。

3、列表的概念，以及如何使用其元素，比如访问、修改、删除、增加、排序、确定长度、避免索引错误等等。

4、如何遍历列表里的元素（for 循环），学会避免缩进错误，如何创建以及使用数字列表，如何对列表切片，如何复制一个列表，如何创建一个元组，如何设置 Python 的代码格式。

5、如何使用 if 语句，比如简单的 if 语句、if-else 语句和 if-elif-else 结构，再比如包括加了关键词 add 和 or 的；学会使用 for 循环遍历列表的同时结合 if 语句。

6、字典的概念；如何使用字典（创建、修改、访问元素、遍历、删除等）；字典的嵌套，比如列表里存放字典、字典里存放列表、字典里存放字典。

7、如何使用输入函数 input()，主要是针对字符串的输入；数字的输入用 int()；while 循环的使用；如何使用 while 循环来处理列表和字典。

8、如何定义一个函数；实参传递给函数的几种方式（顺序实参、关键词实参、默认值）；函数返回值的使用；如何将函数与列表、字典、if 语句、while 语句等结合起来使用，比如把列表当作一个形参在函数里传递列表；如何将函数存储成一个模块供其他函数使用。

9、类的概念；如何创建和使用类（创建一个类后实例化，然后调用其属性和方法，以及如何修改实例的属性值）；如何使用类的继承；如何导入一个类（导入单个类、在一个模块里存储多个类、在一个模块里导入多个类、在一个模块里导入另一个模块等）。

10、如何读取数据；如何写入数据；如何处理异常；如何用 json 存储 Python 的数据结构。

11、如何使用模块 unittest 中的工具来为函数和类编写测试。

## 0101. 起步

如果你按前面的步骤做，应该能够成功地搭建编程环境。但如果你始终无法运行程序 hello_world.py，可尝试如下几个解决方案。

1、程序存在严重的错误时，Python 将显示 traceback。Python 会仔细研究文件，试图找出其中的问题。trackback 可能会提供线索，让你知道是什么问题让程序无法运行。

2、离开计算机，先休息一会儿，再尝试。别忘了，在编程中，语法非常重要，即便是少一个冒号、引号不匹配或括号不匹配，都可能导致程序无法正确地运行。请再次阅读本章相关的内容，再次审视你所做的工作，看看能否找出错误。

3、推倒重来。你也许不需要把一切都推倒重来，但将文件hello_world.py删除并重新创建它也许是合理的选择。

4、让别人在你的计算机或其他计算机上按本章的步骤重做一遍，并仔细观察。你可能遗漏了一小步，而别人刚好没有遗漏。

5、请懂 Python 的人帮忙。当你有这样的想法时，可能会发现在你认识的人当中就有人使用 Python。

6、本章的安装说明在网上也可以找到，其网址为 https://www.nostarch.com/pythoncrash-course/。对你来说，在线版也许更合适。

7、到网上寻求帮助。附录 C 提供了很多在线资源，如论坛或在线聊天网站，你可以前往这些地方，请求解决过你面临的问题的人提供解决方案。

1『第 6 条里的这个网站：[Art & Design | No Starch Press](https://nostarch.com/catalog/art-photography-design)』

## 0201. 变量和简单数据类型

在 Python 中使用变量时，需要遵守一些规则和指南。违反这些规则将引发错误，而指南旨在让你编写的代码更容易阅读和理解。请务必牢记下述有关变量的规则。

1、变量名只能包含字母、数字和下划线。变量名可以字母或下划线打头，但不能以数字打头，例如，可将变量命名为 `message_1`，但不能将其命名为 `1_message`。

2、变量名不能包含空格，但可使用下划线来分隔其中的单词。例如，变量名 `greeting_message` 可行，但变量名 greeting message 会引发错误。

3、不要将 Python 关键字和函数名用作变量名，即不要使用 Python 保留用于特殊用途的单词，如 print （请参见附录 A.4）。

4、变量名应既简短又具有描述性。例如，name 比 n 好，`student_name` 比 s_n 好，`name_length` 比 `length_of_persons_name` 好。

5、慎用大写字母 l 和大写字母 O，因为它们可能被人错看成数字 1 和 0。

要创建良好的变量名，需要经过一定的实践，在程序复杂而有趣时尤其如此。随着你编写的程序越来越多，并开始阅读别人编写的代码，将越来越善于创建有意义的变量名。

1『字符串涉及到的字符串函数有：1）首个字母变大写 title()、修改成大写 upper()、修改成小写 lower()。2）剔除函数，删除首个空格 lstrip()、删除末尾空格 rstrip() 和同时删除首个及末尾空格 strip()。3）拼接用 +。4）制表符 \t、换行符 \n。5）把数据类型转化为字符串 str()。』

在 Python 中，注释用井号（# ）标识。井号后面的内容都会被 Python 解释器忽略，如下所示：

编写注释的主要目的是阐述代码要做什么，以及是如何做的。在开发项目期间，你对各个部分如何协同工作了如指掌，但过段时间后，有些细节你可能不记得了。当然，你总是可以通过研究代码来确定各个部分的工作原理，但通过编写注释，以清晰的自然语言对解决方案进行概述，可节省很多时间。

要成为专业程序员或与其他程序员合作，就必须编写有意义的注释。当前，大多数软件都是合作编写的，编写者可能是同一家公司的多名员工，也可能是众多致力于同一个开源项目的人员。训练有素的程序员都希望代码中包含注释，因此你最好从现在开始就在程序中添加描述性注释。作为新手，最值得养成的习惯之一是，在代码中编写清晰、简洁的注释。

如果不确定是否要编写注释，就问问自己，找到合理的解决方案前，是否考虑了多个解决方案。如果答案是肯定的，就编写注释对你的解决方案进行说明吧。相比回过头去再添加注释，删除多余的注释要容易得多。

编程语言 Perl 曾在互联网领域长期占据着统治地位，早期的大多数交互式网站使用的都是 Perl 脚本。彼时，「解决问题的办法有多个」被 Perl 社区奉为座右铭。这种理念一度深受大家的喜爱，因为这种语言固有的灵活性使得大多数问题都有很多不同的解决之道。在开发项目期间，这种灵活性是可以接受的，但大家最终认识到，过于强调灵活性会导致大型项目难以维护：要通过研究代码搞清楚当时解决复杂问题的人是怎么想的，既困难又麻烦，还会耗费大量的时间。

经验丰富的程序员倡导尽可能避繁就简。Python 社区的理念都包含在 Tim Peters 撰写的「Python 之禅」中。要获悉这些有关编写优秀 Python 代码的指导原则，只需在解释器中执行命令 import this。这里不打算赘述整个「Python 之禅」，而只与大家分享其中的几条原则，让你明白为何它们对 Python 新手来说至关重要。

Python 程序员笃信代码可以编写得漂亮而优雅。编程是要解决问题的，设计良好、高效而漂亮的解决方案都会让程序员心生敬意。随着你对 Python 的认识越来越深入，并使用它来编写越来越多的代码，有一天也许会有人站在你后面惊呼：「哇，代码编写得真是漂亮！」

Simple is better than complex.

如果有两个解决方案，一个简单，一个复杂，但都行之有效，就选择简单的解决方案吧。这样，你编写的代码将更容易维护，你或他人以后改进这些代码时也会更容易。

Complex is better than complicated.

现实是复杂的，有时候可能没有简单的解决方案。在这种情况下，就选择最简单可行的解决方案吧。

Readability counts.

即便是复杂的代码，也要让它易于理解。开发的项目涉及复杂代码时，一定要为这些代码编写有益的注释。

There should be one — and preferably only one — obvious way to do it.

如果让两名 Python 程序员去解决同一个问题，他们提供的解决方案应大致相同。这并不是说编程没有创意空间，而是恰恰相反！然而，大部分编程工作都是使用常见解决方案来解决简单的小问题，但这些小问题都包含在更庞大、更有创意空间的项目中。在你的程序中，各种具体细节对其他 Python 程序员来说都应易于理解。

Now is better than never.

你可以将余生都用来学习 Python 和编程的纷繁难懂之处，但这样你什么项目都完不成。不要企图编写完美无缺的代码；先编写行之有效的代码，再决定是对其做进一步改进，还是转而去编写新代码。

等你进入下一章，开始研究更复杂的主题时，务必牢记这种简约而清晰的理念。如此，经验丰富的程序员定将对你编写的代码心生敬意，进而乐意向你提供反馈，并与你合作开发有趣的项目。

3『

python 交互解释器里输入 import this

```
>>> import this
```

The Zen of Python, by Tim Peters

Beautiful is better than ugly.

Explicit is better than implicit.

Simple is better than complex.

Complex is better than complicated.

Flat is better than nested.

Sparse is better than dense.

Readability counts.

Special cases aren't special enough to break the rules.

Although practicality beats purity.

Errors should never pass silently.

Unless explicitly silenced.

In the face of ambiguity, refuse the temptation to guess.

There should be one — and preferably only one — obvious way to do it.

Although that way may not be obvious at first unless you're Dutch.

Now is better than never.

Although never is often better than right now.

If the implementation is hard to explain, it's a bad idea.

If the implementation is easy to explain, it may be a good idea.

Namespaces are one honking great idea — let's do more of those!

[免费中文 Python 电子书（教程） - FooFish-Python 之禅](https://foofish.net/python-free-ebook.html)

』

## 0301. 列表简介

在本章中，你学习了：1）列表是什么以及如何使用其中的元素；2）如何定义列表以及如何增删元素；3）如何对列表进行永久性排序，以及如何为展示列表而进行临时排序；4）如何确定列表的长度，以及在使用列表时如何避免索引错误。

在本章和下一章中，你将学习列表是什么以及如何使用列表元素。列表让你能够在一个地方存储成组的信息，其中可以只包含几个元素，也可以包含数百万个元素。列表是新手可直接使用的最强大的 Python 功能之一，它融合了众多重要的编程概念。

列表由一系列按特定顺序排列的元素组成。你可以创建包含字母表中所有字母、数字 0-9 或所有家庭成员姓名的列表；也可以将任何东西加入列表中，其中的元素之间可以没有任何关系。鉴于列表通常包含多个元素，给列表指定一个表示复数的名称（如 letters、digits 或 names ）是个不错的主意。

在 Python 中，第一个列表元素的索引为 0，而不是 1。在大多数编程语言中都是如此，这与列表操作的底层实现相关。根据这种简单的计数方式，要访问列表的任何元素，都可将其位置减 1，并将结果作为索引。例如，要访问第四个列表元素，可使用索引 3。Python 为访问最后一个列表元素提供了一种特殊语法。通过将索引指定为 -1，可让 Python 返回最后一个列表元素。这种语法很有用，因为你经常需要在不知道列表长度的情况下访问最后的元素。这种约定也适用于其他负数索引，例如，索引 -2 返回倒数第二个列表元素，索引 -3 返回倒数第三个列表元素，以此类推。

你创建的大多数列表都将是动态的，这意味着列表创建后，将随着程序的运行增删元素。例如，你创建一个游戏，要求玩家射杀从天而降的外星人；为此，可在开始时将一些外星人存储在列表中，然后每当有外星人被射杀时，都将其从列表中删除，而每次有新的外星人出现在屏幕上时，都将其添加到列表中。在整个游戏运行期间，外星人列表的长度将不断变化。

方法 `append()` 让动态地创建列表易如反掌，例如，你可以先创建一个空列表，再使用一系列的 `append()` 语句添加元素。下面来创建一个空列表，再在其中添加元素 'honda'、'yamaha' 和 'suzuki'：

```py
motorcycles = [] 
motorcycles.append('honda') 
motorcycles.append('yamaha') 
motorcycles.append('suzuki')
motorcycles.append('dalong')
print(motorcycles)
```

1-3『 Lisp 里，数组动态添加元素的函数也是 append。（2021-02-19）』

这种创建列表的方式极其常见，因为经常要等程序运行后，你才知道用户要在程序中存储哪些数据。为控制用户，可首先创建一个空列表，用于存储用户将要输入的值，然后将用户提供的每个新值附加到列表中。

使用方法 `insert()` 可在列表的任何位置添加新元素。为此，你需要指定新元素的索引和值。

有时候，你要将元素从列表中删除，并接着使用它的值。例如，你可能需要获取刚被射杀的外星人的 x 和 y 坐标，以便在相应的位置显示爆炸效果；在 Web 应用程序中，你可能要将用户从活跃成员列表中删除，并将其加入到非活跃成员列表中。方法 `pop()` 可删除列表末尾的元素，并让你能够接着使用它。术语弹出 （pop）源自这样的类比：列表就像一个栈，而删除列表末尾的元素相当于弹出栈顶元素。方法 `pop()` 是怎么起作用的呢？假设列表中的摩托车是按购买时间存储的，就可使用方法 `pop()` 打印一条消息，指出最后购买的是哪款摩托车。

```py
del bicycles[0]

motorcycles = ['honda', 'yamaha', 'suzuki', 'ducati']
motorcycles.remove('ducati')
```

如果你不确定该使用 del 语句还是 `pop()` 方法，下面是一个简单的判断标准：如果你要从列表中删除一个元素，且不再以任何方式使用它，就使用 del 语句；如果你要在删除元素后还能继续使用它，就使用方法 `pop()`。

方法 `remove()` 只删除第一个指定的值。如果要删除的值可能在列表中出现多次，就需要使用循环来判断是否删除了所有这样的值。你将在第 7 章学习如何这样做。

在你创建的列表中，元素的排列顺序常常是无法预测的，因为你并非总能控制用户提供数据的顺序。这虽然在大多数情况下都是不可避免的，但你经常需要以特定的顺序呈现信息。有时候，你希望保留列表元素最初的排列顺序，而有时候又需要调整排列顺序。Python 提供了很多组织列表的方式，可根据具体情况选用。

在并非所有的值都是小写时，按字母顺序排列列表要复杂些。决定排列顺序时，有多种解读大写字母的方式，要指定准确的排列顺序，可能比我们这里所做的要复杂。然而，大多数排序方式都基于本节介绍的知识。

要反转列表元素的排列顺序，可使用方法 `reverse()`。假设汽车列表是按购买时间排列的，可轻松地按相反的顺序排列其中的汽车。方法 `reverse()` 永久性地修改列表元素的排列顺序，但可随时恢复到原来的排列顺序，为此只需对列表再次调用 `reverse()` 即可。

使用函数 `len()` 可快速获悉列表的长度。在你需要完成如下任务时，`len()` 很有用：确定还有多少个外星人未被射杀，需要管理多少项可视化数据，网站有多少注册用户等。

刚开始使用列表时，经常会遇到一种错误。假设你有一个包含三个元素的列表，却要求获取第四个元素，这将导致索引错误。发生索引错误却找不到解决办法时，请尝试将列表或其长度打印出来。列表可能与你以为的截然不同，在程序对其进行了动态处理时尤其如此。通过查看列表或其包含的元素数，可帮助你找出这种逻辑错误。

1『列表涉及到的方法有：1）列组末尾增加元素的 `append()`。2）列组特定索引位置处增加元素 `insert()`。3）列组特定索引位置处弹出元素 `pop()`，也可以用语句 del。如果不知道该元素的索引号，但知道它的「值」，可以用方法 `remove()`。4）对列组里的元素进行永久性按字母顺序排序 `sort()`，临时性排序的话用 `sorted()`。5）将列表里的元素反转 `reverse()`。6）使用函数 `len()` 可快速获悉列表的长度，`len(cars)`。』

```py
cars = ['honda', 'yamaha', 'suzuki', 'ducati']
cars.sort()
```

## 0401. 操作列表

在本章中，你学习了：1）如何高效地处理列表中的元素；2）如何使用 for 循环遍历列表，Python 如何根据缩进来确定程序的结构以及如何避免一些常见的缩进错误；3）如何创建简单的数字列表，以及可对数字列表执行的一些操作；4）如何通过切片来使用列表的一部分和复制列表。5）你还学习了元组（它对不应变化的值提供了一定程度的保护），以及在代码变得越来越复杂时如何设置格式，使其易于阅读。

在本章中，你将学习如何遍历整个列表，这只需要几行代码，无论列表有多长。循环让你能够对列表的每个元素都采取一个或一系列相同的措施，从而高效地处理任何长度的列表，包括包含数千乃至数百万个元素的列表。

你经常需要遍历列表的所有元素，对每个元素执行相同的操作。例如，在游戏中，可能需要将每个界面元素平移相同的距离；对于包含数字的列表，可能需要对每个元素执行相同的统计运算；在网站中，可能需要显示文章列表中的每个标题。需要对列表中的每个元素都执行相同的操作时，可使用 Python 中的 for 循环。

假设我们有一个魔术师名单，需要将其中每个魔术师的名字都打印出来。为此，我们可以分别获取名单中的每个名字，但这种做法会导致多个问题。例如，如果名单很长，将包含大量重复的代码。另外，每当名单的长度发生变化时，都必须修改代码。通过使用 for 循环，可让 Python 去处理这些问题。

1『 for 后面有个冒号 `:`，并且下面的 print() 语句一定要缩进。』

Python 再次打印变量 magician 的值 —— 当前为 'david'。接下来，Python 再次执行整个循环，对列表中的最后一个值 —— 'carolina' 进行处理。至此，列表中没有其他的值了，因此 Python 接着执行程序的下一行代码。在这个示例中，for 循环后面没有其他的代码，因此程序就此结束。

刚开始使用循环时请牢记，对列表中的每个元素，都将执行循环指定的步骤，而不管列表包含多少个元素。如果列表包含一百万个元素，Python 就重复执行指定的步骤一百万次，且通常速度非常快。

另外，编写 for 循环时，对于用于存储列表中每个值的临时变量，可指定任何名称。然而，选择描述单个列表元素的有意义的名称大有帮助。例如，对于小猫列表、小狗列表和一般性列表，像下面这样编写 for  循环的第一行代码是不错的选择。

在 for 循环中，想包含多少行代码都可以。在代码行 for magician in magicians 后面，每个缩进的代码行都是循环的一部分，且将针对列表中的每个值都执行一次。因此，可对列表中的每个值执行任意次数的操作。

在 for 循环后面，没有缩进的代码都只执行一次，而不会重复执行。

使用 for 循环处理数据是一种对数据集执行整体操作的不错的方式。例如，你可能使用 for 循环来初始化游戏 —— 遍历角色列表，将每个角色都显示到屏幕上；再在循环后面添加一个不缩进的代码块，在屏幕上绘制所有角色后显示一个 Play Now 按钮。

Python 根据缩进来判断代码行与前一个代码行的关系。在前面的示例中，向各位魔术师显示消息的代码行是 for 循环的一部分，因为它们缩进了。Python 通过使用缩进让代码更易读；简单地说，它要求你使用缩进让代码整洁而结构清晰。在较长的 Python 程序中，你将看到缩进程度各不相同的代码块，这让你对程序的组织结构有大致的认识。

当你开始编写必须正确缩进的代码时，需要注意一些常见的缩进错误。例如，有时候，程序员会将不需要缩进的代码块缩进，而对于必须缩进的代码块却忘了缩进。通过查看这样的错误示例，有助于你以后避开它们，以及在它们出现在程序中时进行修复。

有时候，循环能够运行而不会报告错误，但结果可能会出乎意料。试图在循环中执行多项任务，却忘记缩进其中的一些代码行时，就会出现这种情况。

例如，如果忘记缩进循环中的第 2 行代码（它告诉每位魔术师，我们期待他的下一次表演），就会出现这种情况。第二条 print 语句（见❶）原本需要缩进，但 Python 发现 for 语句后面有一行代码是缩进的，因此它没有报告错误。最终的结果是，对于列表中的每位魔术师，都执行了第一条 print 语句，因为它缩进了；而第二条 print 语句没有缩进，因此它只在循环结束后执行一次。由于变量 magician 的终值为 'carolina'，因此只有她收到了消息 “looking forward to the next trick”。

为避免意外缩进错误，请只缩进需要缩进的代码。在前面编写的程序中，只有要在 for 循环中对每个元素执行的代码需要缩进。

这也是一个逻辑错误，与 4.2.2 节的错误类似。Python 不知道你的本意，只要代码符合语法，它就会运行。如果原本只应执行一次的操作执行了多次，请确定你是否不应该缩进执行该操作的代码。

1『所以说很多 bug 都是逻辑错误。』

for 语句末尾的冒号告诉 Python，下一行是循环的第一行。

需要存储一组数字的原因有很多，例如，在游戏中，需要跟踪每个角色的位置，还可能需要跟踪玩家的几个最高得分。在数据可视化中，处理的几乎都是由数字（如温度、距离、人口数量、经度和纬度等）组成的集合。

列表非常适合用于存储数字集合，而 Python 提供了很多工具，可帮助你高效地处理数字列表。明白如何有效地使用这些工具后，即便列表包含数百万个元素，你编写的代码也能运行得很好。

1『基本思路是用列表、字典等方式储存数据，然后调用各种强大的第三方库来操作这些数据做分析。补充：目前很喜欢在列表或字典里，用「函数」映射处理单个元素。（2021-02-19）』

要创建数字列表，可使用函数 `list()` 将 `range()` 的结果直接转换为列表。如果将 `range()` 作为 `list()` 的参数，输出将为一个数字列表。使用函数 `range()` 时，还可指定步长。例如，下面的代码打印 1-10 内的偶数：`range(1, 11, 2)`。

使用函数 `range()` 几乎能够创建任何需要的数字集，例如，如何创建一个列表，其中包含前 10 个整数（即 1-10）的平方呢？在 Python 中，两个星号（`**`）表示乘方运算。下面的代码演示了如何将前 10 个整数的平方加入到一个列表中。

```py
❶ squares = []
❷ for value in range(1, 11):
	❸ square = value**2
	❹ squares.append(square)
❺ print(squares)

# 不用临时变量
squares = []
for value in range(1,11):
	❶ squares.append(value**2)
print(squares)
```

1『

创建数字型列表就用 `range()` 和 `list()` 的结合体。

```py
list(range(1, 11, 2))
```

』

创建更复杂的列表时，可使用上述两种方法中的任何一种。有时候，使用临时变量会让代码更易读；而在其他情况下，这样做只会让代码无谓地变长。你首先应该考虑的是，编写清晰易懂且能完成所需功能的代码；等到审核代码时，再考虑采用更高效的方法。

1『个人认为，用不用临时变量得试具体情况而定。回复：现在反而觉得应该别用临时变量，更简洁，也是重构里推荐的手段。（2020-08-28）』

前面介绍的生成列表 squares 的方式包含三四行代码，而列表解析让你只需编写一行代码就能生成这样的列表。列表解析将 for 循环和创建新元素的代码合并成一行，并自动附加新元素。面向初学者的书籍并非都会介绍列表解析，这里之所以介绍列表解析，是因为等你开始阅读他人编写的代码时，很可能会遇到它们。

```py
squares = [value**2 for value in range(1,11)]
print(squares)
```

要使用这种语法，首先指定一个描述性的列表名，如 squares；然后，指定一个左方括号，并定义一个表达式，用于生成你要存储到列表中的值。在这个示例中，表达式为 value^2，它计算平方值。接下来，编写一个 for 循环，用于给表达式提供值，再加上右方括号。在这个示例中，for 循环为 `for value in range(1, 11)`，它将值 1-10 提供给表达式 `value**2`。请注意，这里的 for 语句末尾没有冒号。

1-3『

数字列表涉及到的函数：1）`range()` 函数可以生成一系列数字，将 `range()` 函数与 `list()` 函数结合起来即可创建数字列表。2）对数字列表简单计算的函数，比如取最大值 `max()`，取最小值 `min()`，取和 `sum()`。

好好去了解一下列表解析的概念。回复：能用列表解析的实现就用列表解析，简洁嘛，而且在 pandas 作者的那本书（数据分析的那本）里也推荐过这种实现。（2020-08-28）

补充：书籍「2020017Programming-Collective-Intelligence」里也同样强烈推荐了「列表解析」的写法，而且还能增加「条件」筛选。列表解析，做一张术语卡片。（2021-02-19）——已完成

```py
[value**2 for value in range(1, 11) if value > 5]

out:
[36, 49, 64, 81, 100]
```

』

在第 3 章中，你学习了如何访问单个列表元素。在本章中，你一直在学习如何处理列表的所有元素。你还可以处理列表的部分元素 —— Python 称之为切片。要创建切片，可指定要使用的第一个元素和最后一个元素的索引。与函数 `range()` 一样，Python 在到达你指定的第二个索引前面的元素后停止。要输出列表中的前三个元素，需要指定索引 0-3，这将输出分别为 0、1 和 2 的元素。

在很多情况下，切片都很有用。例如，编写游戏时，你可以在玩家退出游戏时将其最终得分加入到一个列表中。然后，为获取该玩家的三个最高得分，你可以将该列表按降序排列，再创建一个只包含前三个得分的切片。处理数据时，可使用切片来进行批量处理；编写 Web 应用程序时，可使用切片来分页显示信息，并在每页显示数量合适的信息。

1『上面的都是切片的实际应用场景。』

要复制列表，可创建一个包含整个列表的切片，方法是同时省略起始索引和终止索引 `[:]`。这让 Python 创建一个始于第一个元素，终止于最后一个元素的切片，即复制整个列表。

```py
my_foods = ['pizza', 'falafel', 'carrot cake']

# 这行不通
❶ friend_foods = my_foods
my_foods.append('cannoli')
friend_foods.append('ice cream')
print("My favorite foods are:")
print(my_foods)
print("\nMy friend's favorite foods are:")
print(friend_foods)
```

这里将 `my_foods` 赋给 `friend_foods`，而不是将 `my_foods` 的副本存储到 `friend_foods` （见❶）。这种语法实际上是让 Python 将新变量 `friend_foods` 关联到包含在 `my_foods` 中的列表，因此这两个变量都指向同一个列表。鉴于此，当我们将 'cannoli' 添加到 `my_foods` 中时，它也将出现在 `friend_foods` 中；同样，虽然 'ice cream' 好像只被加入到了 `friend_foods` 中，但它也将出现在这两个列表中。

1『

复制列表副本的话：

```py
friend_foods = my_foods[:] 
```

』

列表非常适合用于存储在程序运行期间可能变化的数据集。列表是可以修改的，这对处理网站的用户列表或游戏中的角色列表至关重要。然而，有时候你需要创建一系列不可修改的元素，元组可以满足这种需求。

Python 将不能修改的值称为不可变的，而不可变的列表被称为元组。元组看起来犹如列表，但使用圆括号而不是方括号来标识。定义元组后，就可以使用索引来访问其元素，就像访问列表元素一样。相比于列表，元组是更简单的数据结构。如果需要存储的一组值在程序的整个生命周期内都不变，可使用元组。

随着你编写的程序越来越长，有必要了解一些代码格式设置约定。请花时间让你的代码尽可能易于阅读；让代码易于阅读有助于你掌握程序是做什么的，也可以帮助他人理解你编写的代码。为确保所有人编写的代码的结构都大致一致，Python 程序员都遵循一些格式设置约定。学会编写整洁的 Python 后，就能明白他人编写的 Python 代码的整体结构 —— 只要他们和你遵循相同的指南。要成为专业程序员，应从现在开始就遵循这些指南，以养成良好的习惯。

若要提出 Python 语言修改建议，需要编写 Python 改进提案 （Python Enhancement Proposal，PEP）。PEP 8 是最古老的 PEP 之一，它向 Python 程序员提供了代码格式设置指南。PEP 8 的篇幅很长，但大都与复杂的编码结构相关。Python 格式设置指南的编写者深知，代码被阅读的次数比编写的次数多。代码编写出来后，调试时你需要阅读它；给程序添加新功能时，需要花很长的时间阅读代码；与其他程序员分享代码时，这些程序员也将阅读它们。如果一定要在让代码易于编写和易于阅读之间做出选择，Python 程序员几乎总是会选择后者。

1『自己现在也认同了一个观点：代码的可读性排第一位，相比于易修改、可扩展性等，因为可读是前提，看不懂其他都是扯淡，哈哈。（2020-08-28）』

PEP 8 建议每级缩进都使用四个空格，这既可提高可读性，又留下了足够的多级缩进空间。

很多 Python 程序员都建议每行不超过 80 字符。最初制定这样的指南时，在大多数计算机中，终端窗口每行只能容纳 79 字符；当前，计算机屏幕每行可容纳的字符数多得多，为何还要使用 79 字符的标准行长呢？这里有别的原因。专业程序员通常会在同一个屏幕上打开多个文件，使用标准行长可以让他们在屏幕上并排打开两三个文件时能同时看到各个文件的完整行。PEP 8 还建议注释的行长都不超过 72 字符，因为有些工具为大型项目自动生成文档时，会在每行注释开头添加格式化字符。

PEP 8 中有关行长的指南并非不可逾越的红线，有些小组将最大行长设置为 99 字符。在学习期间，你不用过多地考虑代码的行长，但别忘了，协作编写程序时，大家几乎都遵守 PEP 8 指南。在大多数编辑器中，都可设置一个视觉标志 —— 通常是一条竖线，让你知道不能越过的界线在什么地方。

要将程序的不同部分分开，可使用空行。你应该使用空行来组织程序文件，但也不能滥用；只要按本书的示例展示的那样做，就能掌握其中的平衡。例如，如果你有 5 行创建列表的代码，还有 3 行处理该列表的代码，那么用一个空行将这两部分隔开是合适的。然而，你不应使用三四个空行将它们隔开。空行不会影响代码的运行，但会影响代码的可读性。Python 解释器根据水平缩进情况来解读代码，但不关心垂直间距。

3『

[PEP 8 — Style Guide for Python Code | Python.org](https://www.python.org/dev/peps/pep-0008/)

[python/peps: Python Enhancement Proposals](https://github.com/python/peps)

发现 PEP 在 GitHub 上有仓库的，copy 后存入了「2021forked」文件夹，并新建了一个专栏「2021001Python改进提案PEP」。

』