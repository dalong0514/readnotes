# 2019112陈逸鹤的程序员的自我修养R00

## 记忆时间

## 卡片

### 0101. 反常识卡——

这本书的主题核心，就是最大的反常识卡，并且注意时间脉络。

### 0201. 术语卡——

根据反常识，再补充三个证据——就产生三张术语卡。

### 0202. 术语卡——

### 0203. 术语卡——

### 0301. 人名卡——

根据这些证据和案例，找出源头和提出术语的人是谁——产生一张人名卡，并且分析他为什么牛，有哪些作品，生平经历是什么。

### 0401. 金句卡——

最后根据他写的非常震撼的话语——产生一张金句卡。

### 0501. 任意卡——

最后还有一张任意卡，记录个人阅读感想。

## 总纲

第一章谈职业生涯：从程序员职业生涯的角度，阐述了我的一些观点和意见。其中，大部分内容是我的亲身经历，还有一些则是从他人身上获得的经验教训。经过多年积累，深深觉得，如果能让更多年轻程序员或是那些即将走上这条道路的在校大学生早些了解这些经验教训，或许能让他们在将来少走些弯路吧。

第二章谈编程中的实践与认知：讲的则是自己多年的编程实践，以及从中获得的感悟。既有《全栈工程师如何快速构建一个 Web 应用》《一名全栈设计师的 Mac 工具箱（设计、开发、效率）》这样的实践类文章，又包含了《突破程序员思维》《我似乎理解了编程的意义》这样看上去很「湿」，却是我真正希望能够启发年轻程序员们去思考编程本身，以及体会编程意义的文章。

第三章谈程序员的个人发展：以程序员如何变得优秀为话题，从当下有关程序员的各个热点（包括创业、自由职业、建立个人品牌等）入手，为你分析那些优秀程序员身上的共同特质，未来的发展方向，以及值得每一名程序员去做的有益尝试。

第四章谈编程中的教与学：鼓励大家在通过大量技术干货获取技能的同时，也关注那些优秀湿货对于自己成长的重要性。同时，我也对编程教学提出了一些自己的意见和观点。

第五章谈自学设计：在我看来，自学设计是对「美」的意识的重新唤醒，而这一章正是我在自学设计过程中写下的心得及学习笔记。在本章中，我与读者朋友们分享的不是那些设计中的应用技巧，而是如何尝试去理解设计的本质，希望读者朋友们也能以这种态度去学习设计，你会逐渐获得感知并创造美的能力，而这反过来也会促进你编程能力的提升。

目前，网站已收录了会员们分享的将近 500 个各类资源，涵盖了从前端、移动、后端、数据库、大数据开发到设计中的色彩、字体、图标、模板等各个方面。希望这个网站也能像它的名字所表达的那样，能够成为技术匠们汇聚的地方，并帮助更多的程序员或设计师获得成长。

[技匠社 | 资源分享 作品发布 创新合作](http://jijiangshe.com/)

## 总结汇总

2、突破程序员思维；全栈工程师如何快速构建一个 Web 应用；如何成为一名优秀的全栈工程师；为什么每个程序员都应该学习使用命令行；重构，系统改善之道；程序员也该懂得「这样就好」。

## 0201. 谈实践与认知

### 2.1 突破程序员思维

过去我曾一直认为程序员是依靠他们的技术在编程，也是因为技术使得程序员的水平有高低之分。但是，随着我写代码的时间越来越长，接触到的程序员越来越多，我渐渐发现程序员们其实是依靠他们所特有的程序员思维在进行编程，而他们中的佼佼者正是那些有着更高思维成熟度的优秀程序员们。

什么是程序员思维呢？我曾读到过一些文章，试图给它下一个明确的定义，比如，具备抽象和逻辑思维的能力，拥有面向对象编程和设计的能力，等等。我对这些所谓的定义有些不以为然，因为，我所体会的程序员思维更像是一种感觉，它是由常人的思维 + 编程思维，在长期相互作用下产生的一种思维模式。它能够帮助程序员快速找到以程序方式解决现实问题的最优解。程序员们又是如何获得这种思维的呢？我想说，从你学习编程并写下你的第一个 Hello World 程序的时候，程序员思维就已不知不觉地开始建立了，并随着你不断深入地学习与实践，它也变得越来越完善和成熟。

我时常会组织开发团队做一些技术问题的讨论，但当一个问题被抛出时，比如，用户时常会在某段时间内重复地单击某一个功能，导致系统压力的上升。团队的大部分程序员都会很快给出他们的解决方案，比如，增加流量阈的控制或在用户会话中加入某些 Token 来防止用户的频繁重复提交等。但几乎很少有程序员会问，用户为什么会在短时间内频繁单击这个功能呢？是啊，解决问题的关键，往往不是如何通过技术手段禁止用户这样做，而是理解用户这样操作的原因，从而从根本上找出解决的办法。

多年的开发工作，使程序员们不自觉地首先想到如何用技术手段去解决问题，然而，真正优秀的程序员一定善于透过技术发现问题的本质。我想这就是我们突破程序员思维的第一步，也是最容易实现的一步吧。说到方法，我最常使用的是反复地追问一件事的原因，比如刚才这个例子，最终我们找到的原因只是系统没有给用户一个友好的提示，导致用户错误地认为系统并没有处理他的请求，而尝试反复点击。因此，我们的解决方案也与之前团队程序员们所提出的完全不同，只需花上几分钟，给系统加上一句友好的提示就行了。

在很多场合下，比如，与用户沟通需求、与产品经理沟通方案时，程序员总是处于比较弱势的一方。他们只是被动地去接受这些需求和方案，然后回去将它们转换为代码的实现。而那些真正优秀的程序员在与用户进行沟通时，总是试图去理解用户所提出需求背后的真正原因，因为他们知道用户往往会按照自己对问题的理解去给出他们认为正确的方案，而很多情况下，他们所给出的并不是正确或是最优的。那些优秀的程序员会站在用户的角度，认清问题，并像专家一样给出他们认为最优的方案。如果你对一个问题有充分的理解，并具有足够的信心，那么你就应该站出来像专家一样给出自己的意见，这会让你显得与众不同。如果你每次提出的意见都被证明是正确的，那么不需要多久，你也会被大家认同为是一位真正的专家了。

要做到看清问题的本质并像专家一样给出意见，其实并不简单，这不仅需要你具备极强的技术功底，更需要你对问题所涉及的相关领域有足够的认识。你必须通过大量地学习编程之外的各种知识来完善自己的知识体系，并从中获得不同的视角。我经常听到程序员会抱怨用户提的需求质量有多差，设计师做的设计根本无法实现，而产品经理更是被很多程序员视为一文不值，等等。这其中一定存在一些客观的原因，但程序员无法跳出程序员思维，站在用户、设计师、产品经理的角度看待问题，也是一个重要的原因。我在自学设计之后，获得的不仅仅是一项技能，对我帮助更大的是使自己能够从一名设计师的角度来看待问题，这反过来也促进了我的编程能力的提升。同样，你也可以学习某个行业的知识，即使你无法成为这个领域的业务专家，但这些知识能够帮助你更好地理解用户的需求，从而得到更优秀的技术解决方案。这也是为什么我总是鼓励身边的程序员们去尝试学习除编程之外不同东西的原因。

虽然编程是一项脑力活动，但程序员们可能都知道，在大多数情况下这并不需要我们发挥创造力。也就是说，我们在按部就班地完成那些开发工作的同时，也正在失去我们的创造力。创造性地解决问题是优秀程序员所需要具备的能力，但我恰恰发现很多具有多年编程经验的程序员，他们的思维却好像受到了禁锢似的，只能凭着那些已经有些过时的经验去给出他们的方案，而很难创造性地去解决问题。其实，有很多方法都能让我们找回创造力，关键是你是否愿意坚持那样去做。而我的方法也很简单，每天进行阅读，每周写一篇博客记录自己想到的东西。另外，我也有一本小本子用来记录那些转瞬即逝的想法，虽然有些看起来是那么不切实际，但我都会把它们记录下来，没事的时候就去翻翻，这个过程中我可能会得到一些不错又可行的新点子，然后，我再尝试着花些时间把它做出来。虽然，它们中的大部分都不会产生什么实际价值，但我知道下一个优秀的创意或想法，可能就来自于它们。突破程序员思维并不是要摒弃它，恰恰相反，突破正是建立在成熟的程序员思维之上的，这将帮助程序员以更全面的视角去思考和解决问题，同时也能为程序员这个职业创造出更多可能。

### 2.2 全栈工程师如何快速构建一个 Web 应用

如果你问 10 个全栈工程师，如何快速构建一个 Web 应用，我相信你会得到 10 个不同的答案，因为每一名全栈工程师的技术栈都不尽相同。以设计见长的全栈设计师可能会告诉你，做一个很好的设计，然后套用一个博客系统或基于 CMS 的内容管理平台（如 Drupal、Jommla、Wordpress）就可以快速建站；而前端全栈工程师可能会建议用 HTML5+JavaScript（AngularJS 或 React）来写网站的前端，用 Node.js 来写后端服务。我最早是一名 Java 程序员，后来当了架构师，又自学设计，成为了一名全栈工程师。因此，我会更偏向于使用 Java 来构建稳定且易于扩展的后端服务，而用 HTML5+CSS3+JavaScript，再结合一些流行的前端框架来快速写出一个 Web 应用来。当然，这绝对不是唯一或最优秀的技术组合，你需要根据不同的应用场景和你自身的专长来进行合理的选择。

在这篇文章里，就让我们结合网站开发的各个重要阶段（网站定位、功能设定、设计、架构、开发、部署、性能调优、数据统计、开发工具），来谈谈我在构建这个真实 Web 应用过程中的一些思考与实践。

网站无论大小都应该有清晰的定位，也就是你希望你的网站做什么？这一点非常重要，我见过很多网站虽然功能很多，但由于缺少明晰的定位而少有人问津。而我写的这个小站只有一个核心功能，那就是要帮助我的微信订阅用户们（大多是学习计算机或设计的在校大学生和那些工作不久希望提升技能的设计师或程序员们）分享那些优秀的开发或设计（学习）资源。

至此，已经完成了网站的功能设定，我尽可能省略了一切不必要的网站功能，也没有写任何文档，这使我能够以最快的速度将这个 Web 应用实现出来。这种方式也是目前增长黑客们所普遍采用的一种做法：快速搭建出一个具备核心功能的应用原型 ——MVP（Most Viable Product，最小化可行产品），来验证自己的业务模型，然后再根据用户的需求和反馈来不断进行改进。当然，随着项目规模的不断扩大，以及更多团队成员的加入，我们可以回过头来再去补齐那些在前期遗漏的文档。记住，仅当确认文档能够产生价值时，才去编写它们。

这个阶段在不同的团队或项目中会有很多不同的名字，比如，概要设计、业务建模，等等。而我最喜欢信息架构这个名字，因为在这个阶段，我们所要做的就是对不同纬度和粒度的信息进行抽象、规划、设计，从而支撑整个网站的信息体系。我曾经历过很多不同的信息架构方法论，从最初基于模块的设计，到后来的领域驱动设计（DDD）、面向服务的设计（SOA），Oracle 的基于数据建模驱动的设计，再到最新的微服务架构设计，等等。我想说，这些方法论大多是针对那些大规模应用而言的，你需要了解它们，并有意识地在你的系统设计中去匹配这些优秀的架构和设计思想，这有利于你做出扩展性良好的系统，从而避免因整个系统复杂度的提升而导致的大规模重构风险。

我经常在 CSDN、V2EX 等一些开发社区看到一些程序员分享的由他们独立开发的网站或工具。当我访问这些网站时却往往发现，这些网站大多只是简单套用了一个模板或干脆根本没有任何设计。这样的网站虽然功能不错，但很难吸引用户前来使用。我也不是一名设计师，只是利用业余时间自学了设计，但当我需要独立完成一个网站时，我仍然会尽我所能地做一些设计，而为了能够快速实现一个网站，我的做法往往是借助现代网站设计工具（比如 Blocs）或利用现成的网页模板去实现它。在这个项目中，我就用到了一套相对简洁的 HTML5+CSS3 网页模板。

使用模板有很多优点，比如，你可以直接获得优秀的设计，利用网页模板自带的 HTML、CSS、JavaScript 代码可以节省大量开发时间，等等。但使用模板同样会带来一些问题，比如，网页模板可能会包含大量你不需要使用的页面或代码，你需要小心地剔除它们，一些设计师写的脚本很可能存在缺陷，你需要去修复它。同时我想说，你必须首先理解设计才能正确地使用模板，因为模板往往不能解决你所有的设计需求，你总会需要在你的设计中添加一些额外的页面，这时你就必须基于现有的设计，去进行添加或改造。这往往比从头开始进行一个完整的设计还要难，因为你必须保持和网页模板的设计者相一致的设计思路，否则你的网站将变得非常不和谐。而在整个过程中，你必须理解设计的各个方面：色彩、字体、动效、排版，等等。

在做技匠社网站时，用 Sketch 所做的一个资源详情页面的设计。为了得到更好的用户体验，我也会在弹出资源详情页面时，利用 CSS3 的 @Keyframe 给它赋予诸如打开报纸般的简单功效，这能让应用显得更加生动、有趣。

接下来，我要做的便是为网站选择合适的应用架构。我曾为一些银行或保险公司写过底层核心框架，来支持它们复杂或对并发要求极高的业务场景。但对于一个刚刚起步的网站，你完全不需要去做如此复杂的架构设计，只需要尽可能地去使用那些标准和开源的框架和技术就能够保证你做出一个具有良好扩展性的网站。请记住：没有最好的架构，只有最合适的架构。

为了便于系统日后的扩展，我采用了前后端分离的架构设计：前端，目前最流行的两个前端框架是 AngularJS 和 React。在这个项目中我选择的是 AngularJS（https://angularjs.org/）；对于后端，我选择的是基于 Spring Boot（http://projects.spring.io/spring-boot/）的框架，Spring Boot 并不是 Spring 的一个升级版本，而是一个为构建微服务提供更好支持的全新框架。Spring Boot 能够为我提供一个具有良好扩展性的框架，在初期我可以将所有的功能作为一个整体对外服务。随着用户数量的上升，和系统规模的不断扩大，我将可以借助 Spring Boot，并基于 Domain Driven Design 的设计思想将系统的服务进行拆分，构建出一系列微服务。

开发相对来说倒是一件按部就班的事情。首先，基于 Spring Boot 及其他第三方库所提供的 API 来开发出基于 REST 的服务；然后，在前端利用 AngularJS 将应用分为几个模块（UserManager，ResourceManger，FeedbackManager）分别开发；最后，通过 $http 调用后端服务来进行业务处理和数据交互。

虽然我们采用了前后端分离的架构，但在上线初期，我们可以将系统的前端、后端和数据库都部署在一台云服务器上。我们需要选择一个云服务提供商，将应用部署上去。我选择了阿里云服务器来部署我的应用。在操作系统方面，我选择的是 Ubuntu Linux。在其他硬件方面，除了带宽，我选择了 3M 之外，其他我都使用的是最低的配置，因为根据上线初期的用量评估，这样的配置已经足够使用了。当用户和规模增加时，可以通过升级配置的方式来获得更多硬件资源，这一点还是非常方便和经济的。

后端：由于采用了 Spring Boot，所以后端的服务可以用 Maven Plugin 直接打包成一个可运行的 jar 包，它集成了 Jetty 服务器可以直接向外提供 REST 服务。当然，如果你不喜欢 Jetty，那么也可以通过在 pom.xml 中简单地修改配置来集成 tomcat 作为你的应用服务器。最后，在你的服务器启动脚本中，简单地使用 Java-jar 命令，就可以启动你的后端服务了；前端：前端是一个静态网站，包含 HTML、CSS，以及图片文件。我将它部署在了一台 Apache 服务器上，当然你也可以选择 Nginx 这样的高性能服务器。

你需要定义出网站的安全策略，比如，用户组，用户权限的分配，出于对安全的考虑，尽可能将不需要开放的端口用防火墙隔离，只保留 80 等几个对外提供服务的端口，等等。另外，如果你的网站交互中包含一些敏感的信息，那么你还应该使用 TLS 对数据的传输进行加密处理。

在正式上线之前，你还应该对网站做一些性能调优，以保证网站能够有比较好的响应速度。使用 YSlow 等工具是一个不错的选择，它能告诉你网站加载缓慢的原因，并给出优化的建议。

网站上线后，你仍然需要对网站的访问量、用户情况进行持续的统计和分析。大家可能发现在网站的功能里我们并没有加入相应的用户访问跟踪模块，是的，我们可以借助第三方的统计平台来帮我们做这件事。由于国内无法使用 Google Analytics，因此我选择了百度统计。你只需要在百度统计中注册一个账号并加入你的站点，然后在你的网站头部加入一小段 JavaScript 代码就能实现最基础的网站统计功能了。当你需要更多用户个性化分析时，可以在应用的内部增加相应的模块来进行数据的抓取和分析。

### 2.3 如何成为一名优秀的全栈工程师

我认为全栈工程师应该同时是一位资深开发工程师、架构师，以及具有敏捷开发技能的程序员。全栈工程师对于软件开发的认识往往已经进化了，他们把特定的技术抛到了身后，明白技术的更新始终比计算机理论要快的道理，因此，他们注重强化自身的核心技能，关注并乐于实践其他技术。全栈工程师往往是某一方面的专家，同时通晓并善于在正确的场合运用其他语言、工具和技术。

关键开发技能（硬实力）如下：

1、Git/GitHub—— 你必须掌握如何使用 Git 来管理和分享你的代码。把 Git 作为关键技能的第一条，是因为它不仅仅是一个代码管理工具，更是一种推荐的工作方式。它使你能在任何地方进行开发，高效地管理任何大小的项目，通过 Git 你还能与其他团队成员进行分布式协作，大大提升工作效率。通过 GitHub，还能将你与世界所有的开发者联系在一起。

2、至少一门编程语言 —— 你需要精通至少一门编程语言，如 Java、PHP、Swift、C#、Python、Ruby、Perl 等，因为你的大多数核心业务处理都需要用这门语言来写。你既要掌握这门语言的语法，又需要非常熟悉如何基于这门语言进行项目的架构、设计、实现及测试。如果你选择的是 Java，那么你就需要掌握面向对象的设计和开发、设计模式的应用、基于 J2EE 各个组件的开发，等等。

3、运用开发框架和第三方库 —— 流行的开发语言，一般都伴有出色的开发框架，比如，Java 的 Spring、MyBatis、Hibernate，Python 的 Django，PHP 的 thinkphp、yin，nodeJs 的 express，等等。这些开发框架往往都遵循软件开发领域的一些最佳实践，并由非常优秀的开发人员创建。熟练使用这些开发框架或第三方库能够避免重复发明轮子，从而使你的工作事半功倍。更重要的是这些优秀框架或第三方库一般都得到持续的维护，是对你的产品或项目在质量与安全方面最有效的保障。

4、前端技术 —— 之所以将前端技术独立出来，作为一项关键技术，是因为它在今天的项目和产品的研发过程中正变得越来越重要。一个产品除了实现所需的功能之外，是否好用（用户体验）也正在成为评判一个产品是否成功的重要标准。而这都依赖于前端技术的实现，你至少需要掌握 HTML5、CSS3、JavaScript 等基本前端技术，同时进一步学习 JQuery、LESS、SASS、AngularJS 或 REACT 等前端框架或第三方库。

5、数据库与缓存 —— 任何产品或项目都需要一个数据库来存储数据。作为全栈工程师，你也需要至少掌握一到两种数据库，并知道怎样与数据库进行交互。目前流行的数据库主要包括 MySQL、MongoDB、Redis、Oracle、SQL Server 等。MongoDB 作为文档型数据库，在互联网产品中正被越来越多地使用，对于规模稍大一些的项目，我仍推荐使用 MySQL 或商用的 Oracle 作为后端数据库。而 Redis 这样的内存数据库则可以用于缓存，以提升系统的性能。

6、基本设计能力 —— 大部分关于全栈工程师的文章或讨论中，都不会将设计能力作为全栈工程师的关键技能，但我却认为这项技能非常重要。我曾被邀请评估一些软件工程师自己开发的产品，这些产品都有不错的创意，功能实现也很到位，但其中一些一看就不是一个好的产品，用户根本没有使用欲望，原因是这些产品的设计太差了，而那些开发者往往完全没有意识到问题的存在，比如，色彩不一致、排版凌乱、图标不恰当，等等。我所建议的基本设计能力，并不要求你像专业设计师那样能够 P 出神图、制作奇妙的视觉效果等，但你需要掌握那些最基本的 UI 设计原则，如色彩的搭配，基本的排版，并具备良好的审美能力和一些基本 UI 设计能力，这样你做的产品就不会太差了。

在掌握了这些核心技能之后，你可以根据自己的兴趣与发展方向，学习其他方面的技术。比如，如果你对数据处理感兴趣，那么你可以学习大数据方面的技术；如果你对移动互联网更感兴趣，那么你可以学习 Swift，开发 iOS 应用。知识总是相通的，在有了良好的技术基础后，学习其他知识将会变得非常容易。

附加技能（软实力）如下：

1、沟通 —— 除非你是在做个人项目，对于稍大一些的项目，你总是需要与同事、干系人或是客户进行沟通。而成功的沟通往往是获得有效需求与建立团队树立信心的第一步。在项目进行的过程中，你更需要通过有效的沟通去确定方案，消除误解，与项目成员协同前进。良好的沟通能力将使你在团队中更具影响力，受到更多尊重和关注。

2、问题解决能力 —— 全栈工程师首先是一名工程师，他必须掌握用工程化的方法来解决遇到的各种问题。我在职业生涯中的几乎所有亮点，都与解决问题相关，大到提供整个项目的架构方案，小到以最快的速度解决生产问题，等等。其实，有很多提高问题解决能力的方法，但没有一种比实践更有效。我所见到的优秀工程师，往往能够凭借直觉以最短的时间给出正确的解决方案，但你没有看到的，是在这背后经过大量实践累积而来的经验。

3、时间管理 —— 作为全栈工程师，你可能会被安排同时在不同的项目中承担不同的角色。你需要合理地分配时间，保证所有的工作能够按时交付。同样在你的业余时间，你还需要花时间阅读和学习，同时你还可能有自己的 Side Project。因此，合理地进行时间分配，并对一些关键任务进行计划是很重要的。你或许会感到一些压力，但这反而会激发你的创造力，并能让一切都有条不紊地进行。

4、好奇心 —— 对任何工作都抱有好奇心，并愿意不断学习和改善是那些优秀工程师的共同特性。软件开发领域汇集了世界上最聪明的人，各种类型的技术、产品、框架更是日新月异，层出不穷。优秀的全栈工程师需要不断地学习来抓住这些变化，跟上计算机领域发展的脚步。时常有人会问我，做计算机这一行一直会有新的东西产生，要去不断地学习，是不是会很累。我要说的是，对于将持续学习作为一种生活习惯的人来说，学习新东西并不会成为一种负担，反而是一种乐趣。

5、领导力 —— 优秀的全栈工程师往往会被赋予技术 Leader 甚至项目管理者的角色。成为管理者并不是让你去支配其他人，或让其他人替你做事。管理者需要理解你的团队成员的长处与不足，并知道如何以服务的态度使团队获得最大化的产出。我见过一些非常优秀的工程师，当他们被安排去管理团队时，他们是排斥的，他们往往更愿意独自工作。但我想说，成为管理者将会使你更加睿智、可靠和值得他人信赖，也会对你未来的职业生涯带来极大的益处。因此，当机会到来时，请将它视为挑战，不要排斥它。

有经验的技术领导者在招聘时，往往会同时考察应聘者的技术能力与上述附加技能，而对于初级程序员的招聘来说，那些附加技能往往更被优秀的技术公司所看重。开发技能是你的硬实力，而附加技能则可以看作是你的软实力，只有同时具备这两方面技能，才能成为一名优秀的全栈工程师。

### 2.4 为什么每个程序员都应该学习使用命令行

在我的印象中，很少需要用命令行去完成什么工作。这种情况一直持续了很久，以至于我下意识地认为任何软件工具都应该有一个图形界面。但最近几年这种情况发生了改变，几乎所有的工具软件都不约而同地变得更加简单而纯粹，它们精简了那些不必要的功能，不再一味追求大而全，而是更加注重用户的感受和使用效率。其中一些非常优秀的软件工具更是抛弃了图形界面，要求用户通过命令行直接进行操作。这一改变当然也对我的工作流程产生了影响，它变成了现在这个样子：

打开电脑，启动 Mac 操作系统 → 打开 Sublime 和 Eclipse → 通过命令行输入 3 条命令（mongod；redis-server；grunt serve）启动我的本地调试环境 → 开发 → 通过命令行（git commit；git push）提交我一天的工作代码 → 结束工作。

### 2.5 重构 —— 系统改善之道

我常常喜欢把一个系统比喻成一辆车，你需要经常对它做维护和保养，才能保证它的良好运作。如果不这么做，那么，虽然看着能开，但某一天一个严重的问题就会导致极其危险的后果。而持续重构就是我们给系统做的保养，这对于保证系统的稳定运行非常关键。

在大部分我重构过的项目中，起初自动化单元测试都是缺失的。由于对核心功能的重构，往往涉及大量代码的反复修改，因此，通过引入单元测试，可以非常有效地避免因重构造成的关联影响。而通过重构完善自动化测试，在我看来也是一个很好的重构实践，它将为我们未来的持续重构打下良好的基础。

对于上面这些代码中的坏味道，你应该一有机会就尝试去重构它们。但要记住，你不应该操之过急，想着一下子把所有问题都一起解决。你需要先识别这些问题，然后分步骤地逐步去解决，而每次重构时你都需要充分识别可能造成的关联影响。如果你已经为你的代码写了单元测试，那你的重构将会有很好的测试保证。如果没有，那么你也可以尽可能找人帮你 Review 修改的代码，因为不同的人来看你所修改的代码总是能发现一些你没有意识到的东西。另外，我们现在使用的 IDE 也能为我们提供很多帮助，比如，找出要重构的方法在哪些地方被调用，或者要重构的类的层级关系，等等。它还能帮助我们自动地去重命名一个变量、方法甚至是类。

最后，让我们从架构的角度来看看系统的重构。说到架构，时下最流行的一定是「微服务」架构了。在我看来，微服务并非是一个全新的架构方法论，而是对 SOA—— 面向服务架构的一次升级。它的出现源于云计算、容器技术、DevOps 等技术，以及全新运维理念的不断成熟。

由于采用微服务架构，所以我们并不会在原有系统上进行重构，而是创建一个新的基于 Spring Boot 的项目，将原有系统的功能，逐步拆分成一个个服务，并将它们添加到新的项目中，然后利用一些开关设置，将原有功能平滑地切换到新的基于微服务的系统中，这是与以前系统重构的一个很大区别。使用微服务框架，可以使开发变得更加简明，然而，它的难点恰恰在于服务的发现与定义。系统中的哪些服务应该被独立出来，形成对外的服务，服务的粒度又应该是怎样的呢？我在做相关架构时，其实参考了领域驱动设计的思想，先识别出系统所包含的那些领域模型，然后按照领域的划分与不同的粒度来规划系统的服务。重构虽然无法直接创造业务价值，但却能显著提高系统的可维护性，所以你在重构上所投入的每一分钟，都会为未来节省更多的维护时间，这也是为什么我们需要坚持持续重构的原因。

### 2.6 程序员也该懂得「这样就好」

日本给我留下的最深刻印象并非大家常常挂在嘴边的干净、空气好、服务礼貌周到等，而是那些无处不在的设计体现，产品的包装、一块指路牌、路边小食店的招牌等，虽然它们的形式、用途各不相同，却总能给人以简朴、精致、人性且颇具内涵的舒适感觉。我想可能正是这些由小及大、无处不在的美才培育出了今天这个相对成熟的日本社会吧。

说到设计，我曾读过一些日本设计师的书，田中一光的《设计的觉醒》，黑川雅之的《设计与死》，原研哉的《为什么设计》《设计中的设计》《白》等。这些日本设计大师所提出的并不断被继承的极简、去修饰、设计的功能性等理念都深深印刻在了当代的日本设计之中。而其中让我最受启发的，却是他们用最直白语言告诉我们的「这样就好」。

作为一名程序员，我在进行系统设计时，也时常会提醒自己：「是不是这样做就好了呢？如果没有必要，我们就不需要增加这个附加功能了」。也正是在「这样就好」的指引下，我对如何正确地进行系统与程序设计似乎有了更深入的理解。

优秀的系统绝不可能凭空产生，也没有一个统一的标准，而「这样就好」却能指导我们这些系统设计者，在众多选择中做出平衡与取舍。比如，该使用什么样的架构，采用哪种技术，在这个功能中使用什么设计模式，采用何种缓存策略，等等。这些都需要我们根据当时的环境、资源、用户等要素做出恰当的选择。与其提供很多功能而最终用户却始终觉得不好用，倒不如做好一个能真正帮助用户解决问题的功能，让用户觉得，「嗯，这样就挺好」，然后再进一步，「如果能…… 就会更好了」，这样一步一步做出理想的产品来。在这一过程中应注意以下 3 点：不盲目使用新技术；避免过度设计；不在项目中技术镀金。

最后，我需要提醒大家，即使你已经理解了「这样就好」，并能提出更合理的系统设计，但结果还是很有可能遭到否定。因为，你所需要面对的或许是那些不那么成熟的项目经理、盲目自大的产品经理，以及完全没有产品思维的业务用户，而在他们眼中那些糖衣炮弹（系统的附加功能）总是有着非同一般的吸引力。你可以尝试着去说服他们，即使失败了，你也不用为此感到沮丧，因为时间会证明你是正确的。并且你的内心也应该意识到，自己正变得更加成熟，并且已经站到了更高处。

### 2.7 走出软件开发法则

如果你也是一名程序员，那么相信从你第一天学习编程起，就会被灌输很多关于软件开发的法则，它们有些来自于课堂，有些来自于书本，还有些来自于工作中前辈的教导。我们总是努力地去学习这些法则，然后再将它们传授给更多后来人。然而，我们是否只是不假思索地接受它们，而没有真正尝试着去理解过这些软件开发中的法则呢？

「面向对象」并不是一句假、大、空的口号，它其实为我们提供了一种思维方式，帮助我们更好地进行软件的构建、组织及复用。但要想掌握这种思维方式却并不简单，虽然我们都知道正确的价值观应该是怎样的，但一旦需要应用到自己身上却很难做到一样，面向对象的思维方式也需要通过不断的实践运用才能获得。然而大部分程序员并没能这么做，或者说没有机会去进行更多的练习。今天的开发与以往相比已经大大简化了，那些底层需要复杂抽象的设计都有了可以直接拿来使用的框架，程序员要做的更多是基于这些框架去写业务实现逻辑。虽然开发变得更简单了，但这却在一定程度上减弱了我们的编程能力，也闹出了不少程序员不会编程的笑话。当我们需要运用面向对象的思维去进行分析和设计以解决那些复杂问题时，往往就会觉得力不从心，无法精准地完成它们。

我所看到的另一个更让人担忧的问题是，很多程序员错误地认识了面向对象。比如，他们会想当然地认为，面向对象就是把任何实体描述为一个 DTO（Data Transfer Object），用 Getter、Setter 方法去存取它们的属性，然后在其他业务组件中去处理它们。这的确是一个常见、也在大部分编程书籍中被作为代码示例的应用模式，但我想说 DTO 真的被滥用了。当你必须把所有实体看作 DTO 时，本身你的编程思维就受到了限制，你所开发的程序也将变得机械，缺乏扩展性，越来越难以维护。DTO 只是面向对象中描述对象的一种形式，你应该以更高的高度去判断一个实体应该如何表现。比如，数据库中的某一条记录，它既可以通过那些 OR Mapping 框架被映射为 DTO，同样，你也可以创造一个类似 Record 这样的键值对的类来表示它，而后一种往往在批量数据分析、报表加工等场景下更加合适。

我们需要具备面向对象的编程思维，但在我们没有真正拥有它之前，也千万不要被那些已有的原则、模式和框架束缚住你的思维，多看那些优秀的程序，思考自己的每一次程序设计，并及时进行总结和反思，你将会从中逐渐获得超越面向对象本身的正确编程思想。

测试的重要性不言而喻，从倡导进行单元测试，到 TDD（测试驱动开发），我们似乎对程序员进行严格的测试并保证代码质量有了越来越高的要求。今天，有很多开发团队都会要求程序员们采用 TDD 等方式来测试他们的代码，甚至还会通过测试覆盖率等指标来对程序员进行考核。这不禁让我想到，我的一位来自马来西亚的同事曾经为了满足公司对代码注释行数的要求，而把一行注释硬是拆成每个单词一行的趣事。我们是不是又一次为了满足某种教条而本末倒置地去做一些不那么必要的测试了呢？

几乎每隔 2、3 年我们就能看到软件开发领域诞生一套新的方法论，比如在软件架构领域，我们经历了面向模块、面向组件、面向服务（SOA），直到今天我们提出微服务架构。而在开发流程与团队协作领域，我们又经历了从瀑布式和工程化的开发方法到敏捷、XP、Scrum 开发，以及今天我们经常挂在嘴边的 DevOps。每一种新方法论或思潮的出现，都会伴随着新一轮大规模的系统改造，同时也会对团队协作方式产生巨大影响。当我们对这些新的潮流趋之若鹜之时，是否也曾想过这些最新流行出现的原因，以及它们是否真的适合你的企业或团队呢？

我曾作为甲方参与由一家知名咨询公司所组建的开发团队，团队的任务是开发一套集团内部的电销核心系统。这个开发团队号称采用了 Scrum 的管理方式和流程。但我很快发现，那些所谓的 Scrum 方法往往只是停留于表面的形式而已，比如，每日的 Standup 晨会，团队成员们只是例行公事般报一下流水账，而在开发过程中采用更小的迭代及每日集成等方法，同时，由于团队成员技能的参差不齐，而经常导致项目版本的延误，或者因不必要的等待造成的开发效率低下等问题。与之类似，诸如结对编程等在国外流行起来的开发方式，我也几乎从未在国内开发团队中看到成功的实施案例。

那么，我们又应该如何看待这些层出不穷的方法论呢？在我看来，这些所谓方法论都出现在不同的时代大背景之下，又与当时的技术环境紧密相关。比如，SOA 最流行的时候，恰恰是那些大型企业为了应对内部日益复杂的业务需求而提出的，而作为它的基础设施的提供者，像 IBM、WebLogic、Oracle 等一批中间件服务厂商也在那个时期获得了快速发展。而今天微服务架构及 DevOps 的出现，则是为了应对当今互联网环境下需求的快速变化，以及越来越复杂的运维场景而产生的，它们更是与当前云计算、大数据等领域的飞速发展紧密相关。不难发现，无论是软件架构还是开发协作，这些方法论都在引导着我们向更小、更高效和更能适应变化的方向发展。对任何企业或团队来说，永远不存在万能的方法论，你需要根据自己所在企业所面临的问题和目标，来对这些流行的业界最佳实践进行深入的分析，然后通过合理切割或补充，得到对自身最行之有效的实践方法，而不是像赶时髦一般去急着应用那些所谓的最新技术或方法。

程序开发领域中还存在很多可以拿来探讨的问题，通过对这些问题的思考，我们发现在软件领域并不存在那些非黑即白的所谓真理或法则。程序开发的美妙之处也正在于它充满着令人兴奋的变化和各种抽象思维。不要被任何思想、教条、方法论束缚住你的思维，只有这样，你才能真正体会到程序开发所带来的乐趣。

### 2.8 我无法写出易读的代码

我相信很多程序员一定都读过《代码大全》、Effective Java、《设计模式》等介绍如何写出更优秀代码的书籍吧。而程序员们在写代码时，也确实遵循着书中的那些最佳实践，努力地去写出高质量的代码。但当他们编写一些更复杂的程序时，所写出的代码就会变得越来越难以阅读，即使加上了很多注释，这种情况也不会得到明显的改善。

这是程序员的问题吗？不，至少我认为不是这样的。因为代码并不是自然语言，它本来就是难以阅读的，况且代码是否易读不仅与代码本身有关，还与阅读代码的人对系统的理解程度，以及他们自身的技术水平有关。更何况，我们写代码的目的本身也不是为了让它更容易阅读。

我很喜欢拿写作与写代码进行比较，当我们写完一篇文章后，我们常常会反复修改，直到它变得流畅易读为止，因为只有这样，读者才能明白你的文章所要表达的内容。但对于编码而言却不是这样，我们写代码是为了实现功能、解决问题，因此我们一般都会通过测试来进行验证，但极少会为了让它变得易读，而去修改它。与代码的准确性相比，显然代码是否易读就变得次要很多。

1『不是很赞同作者的这个观点。』

推行模式（Patterns）而非建立规范。我见过很多项目团队，在开始编码之前，都会相应地制定一整套代码规范（多的达到几百条），但随着项目的深入，我们却发现，代码的质量还是失控了。虽然表面看来，每个人都在遵守着那些代码规范，但其实他们的思维却没有得到很好的统一。想象一下，在一个阅兵式上，一队身着统一制服的士兵，他们每个人的动作都非常标准，但他们都在按照自己的节奏和步点做动作，这场面是不是有些滑稽呢？我所推荐的方法是推行模式（Patterns），在项目进入开发阶段前，就将那些开发过程中会遇到的相同类型的问题进行分类，并为它们创建统一的模式（标准的处理方式），比如：1）使用什么结构来表示数据本身。2）采用哪种机制来进行数据加工。3）如何进行统一的错误处理。4）会话的管理及使用策略。5）哪些地方需要记录日志。6）包与方法的命名 Name Convention……

在项目的进行中，我们也需要不断地去识别那些带有共性的问题，并为它们建立新的模式，然后再推广到项目中。

如果你没有熟练掌握驾驶技术，或者对所驾驶的车不熟悉的话，你将很难体会到驾驶所能带给你的乐趣。编程和驾驶一样，你需要同时掌握所使用的编程语言和所在系统的应用框架，才能非常自如地进行开发。

每个公司或项目在开发一个产品时，往往都会建立或使用一套自己的框架，它们一般都是基于 Spring、Struts 这样的流行框架之上的。在大多数情况下，构建应用框架的目的并不是为了给开发者提供一个比 Spring 更强大的框架，恰恰相反，它们在大多数时候，是为了限制框架的使用，而使整个系统变得更加标准且易于维护。你需要理解这一点，并在开发时尽可能使用应用框架所提供的标准方法。如果框架无法满足你的某些需求，那么可以尝试与架构师沟通，是否需要对应用框架进行扩展，或找出合理的解决方案。如果你没有这么做，而是跳过应用框架，直接使用那些更底层的框架方法或 API，那么将会给系统带来坏味道，而这将引发连锁反应，更多坏味道会接踵而至，最终导致整个项目变得混乱而难以维护。

当然，要想深入理解你所使用的应用框架也绝不是件容易的事，光靠那些开发指南和代码示例是不够的，你还可以通过阅读源码，以及大量的实践去深入地理解它们，并训练出最有效使用它们的感觉。最终当你进行开发时，那些正确且标准的框架使用方法会非常自然地出现在你所敲击的每一行代码中。

当我们的技术水平有所提升后，会不自觉地想着去使用一些不太常见的技巧。使用这些代码往往能够以非常 Cool 的方式快速解决问题，但如果这样的代码过多，也会让系统变得难以理解。程序员们经常使用的另一个所谓的技巧便是「可配置」。他们经常会在与用户讨论需求时，推销他们可配置的点子，好像只要做到了这一点，他们所开发出来的功能就能胜人一筹似得。而结果往往是，那些所谓的可配置功能，用户极少会去使用，而为了这些配置，却大大增加了系统的复杂性，而系统的性能也因此变得低下。因此，我总是不鼓励程序员们去写过多 Hack Code 或为了引入那些不必要的可配置功能而使整个系统过于复杂。

流程有时也能帮助我们写出更好的代码，Design Review 和 Code Review 就是其中非常重要的两个。Design Review 能够帮助我们在较早的阶段就发现那些潜在的设计问题，并加以纠正，这往往能发挥事半功倍的效果。在实践中，我总是会建议采用最简单的设计文档模板，并让开发人员写下真正体现他们所做程序设计的内容。这一方面可以避免因过多 Paper Work 而导致的效率降低，同时，设计文档中只包含那些真正重要的东西，也会使文档本身变得更易于维护。在程序员开发完成后，由另一位较资深的程序员来进行 Code Review 也能很好地识别出代码中的一些疏漏。更有益的是，通过这样的 Code Reivew 能够形成一种非常有效的反馈机制，帮助那些初级程序员快速成长。

团队中存在着不同的角色，项目经理、产品经理、业务分析人员、架构师、资深开发工程师和普通开发工程师。其中，架构师作为最技术的那个角色显得尤为关键，他甚至可以成为一个项目成功与否的关键人士。架构师应该承担起应用架构、代码规范制定、系统接口定义、技术风险识别、指导团队开发等很多工作。因为在真实的项目场景中，我们随时面临着架构方面的问题，所以架构师不应仅仅出现在项目的开始阶段，而应该服务于整个项目生命周期中，在需要解决棘手的技术问题时，挺身而出，快速而准确地解决问题。但遗憾的是我们经常看到架构师在团队中只起到了顾问的作用，他们甚至不亲手写一行代码，只是给出一些系统部署、核心设计方面的建议后，就早早地退出了项目。让你团队中的架构师忙起来，同样对你团队成员的成长有很大的帮助。特别对于那些年轻程序员，通过理解架构师给出的技术解决方案，以及阅读他们所写的代码，都能帮助他们提高编程能力。更重要的是，他们将慢慢学会像那些技术专家一样去思考和解决问题。

最后让我们回到编写代码本身上来，在文章的一开头我就提到，对于那些复杂的程序逻辑，你很难写出易读的代码，那真的就一点办法也没有吗？我所能给出的唯一建议便是「小比大好」。当一段逻辑变得比较长时，就将它拿出来，起一个与这段代码功能相对应的名字，封装成一个新的方法。这听起来显而易见，但我告诉你大部分程序员并不会那么做，因为他们似乎遵循着另一个原则：只有当一段逻辑会被多次调用（大于等于两次）时，才为它创建一个新的方法。所以，我们便看到了包含几百行代码的方法。这个原则本身并没有错，但我们可以做适当的补充，除了在考虑复用性的基础上拆分方法之外，我们也可以为了代码的可读性和可维护性去进行拆分，这样将大大提高了复杂功能逻辑的易读性。可能你又会问，这样做不是会让代码变得很散，到处都是方法吗？我还是想说「小比大好」，就像我们现在修理汽车更多的是更换那些存在问题的零件一样，通过将逻辑拆分成更多小的部件，在维护时我们可以更方便地进行替换从而降低开发成本，以及因关联性判断不足而带来的风险。虽然，我仍然无法写出易读的代码，但通过对上面这些方法的实践，我却能在大多数项目中写出清晰且易于维护的代码。我想，这可能对于整个项目和团队来说，是更加重要的吧！

### 2.9 一名全栈工程师的 Mac 工具箱（设计、开发、效率）

但我也很清楚，我不可能像那些真正的设计师那样掌握很多设计技巧，并做出非常优秀的作品来。我所能做的是，一方面通过自学提升自己对设计的认识，另一方面我一定会精心挑选设计工具，来尽可能地弥补我设计技能上的不足（这两点同样重要，如果你和我一样也是一名对设计感兴趣的程序员，那么可以读读我之前写的《自学设计，你真的入门了吗？》，其中描述了我自学设计的经历、方法和一些认识）。

[自学设计，你真的入门了吗？ - 简书](https://www.jianshu.com/p/744fb80e7d72)

### 2.10 我似乎理解了编程的意义

我的职位也由原来的初级程序员变为了资深开发工程师，以及后来的架构师。相应的，除了编程之外，我工作中的很大一部分时间需要用来与用户进行沟通，并分析他们提出的需求。对于我来说，这个角色转换的过程是艰难甚至有些痛苦的。我不得不用自己最薄弱的沟通技能去和用户打交道，更要命的是我所习惯使用的那些技术语言有时很难让他们理解。

我很快意识到自己已不再是那个只需被动接受任务安排，并将自己的编程工作完成好就万事大吉的程序员。除了技术之外，我更需要能够突破程序员思维，去发现用户需求背后所隐含的真正问题。我比以前变得更加务实，不再刻意追求技术的高深，而是尽可能从问题本身出发，选择最有效的技术手段去解决它。此时，编程的意义也发生了改变，它已不再局限于技术本身，而成了解决问题的理想工具。

编程对于我来说已不再是一项技能或是工具，我是在通过编程进行着自我表达与创作，这种感受带给了我极大的自由度，而我也从中感受到了前所未有的喜悦与乐趣。

公司里最近都在为一个老系统的升级问题发愁。这个系统已经运行了将近 20 年时间了，为了升级系统，大家不得不深入到这个系统的框架中，去读底层代码。我们读到了一位已经退休的美国同事 Bill 所实现的数据库连接池代码。在那个时候 Java 刚开始流行，还没有像 Spring 这样的框架，或是如 Hibernate、MyBatis 这样标准的持久层实现，这个系统中所有的数据库连接池及核心持久层代码都是由这位美国同事写的，这些代码让整个系统稳定运行了将近 20 年，大家都不禁为他高超的技术水平发出由衷的赞叹。

我还认识一位从事证券交易软件研发的公司 CTO，看年纪他应该已经接近 50 岁了，但他仍然在亲自编写那些证券交易的核心代码。当我问他为什么到了这个年龄和职位，还要坚持写代码时，他告诉我，当他看到自己所写的代码每天在支撑着千亿级的证券交易时，他感到非常兴奋和自豪，并不断希望能够通过自己的努力将它做得更好。